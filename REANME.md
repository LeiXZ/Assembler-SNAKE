汇编语言贪吃蛇实验介绍

1.实验要求
写一个或多个中断服务程序，最好和加载器能关联起来，作为工作程序启动。
2.程序功能介绍
贪吃蛇小游戏，可以实现实现蛇的移动、键盘控制、吃果子改变分数、撞墙（撞自己）的判断、达到一定分数时变色。同时也有相应的开始和结束的界面。
3.功能实现的过程
（1）移动
贪吃蛇移动的过程我分两部分介绍，第一部分是移动过程的具体实现，第二部分是和中断关系。
贪吃蛇的移动功能大体的实现步骤是：显示->延时->清空->移动->显示。贪吃蛇表示的方式是用一个数组来记录蛇身体的每一个结点的显示屏行列坐标。因此蛇的显示就是在这些坐标上显示符号’#’，蛇的擦除就是在这些坐标上输出空格。
蛇的移动首先是利用课本上第四章学到的利用STD指令倒序数据块转移，把第1~n-1个数据转移到2~n个，然后根据移动状态修改头结点的坐标。延时的方法刚开始我用的是循环nop指令，之后我和时钟中断结合，使其每隔0.3秒左右移动一次。
课本上有一个中断处理函数例子是获取当下时间，每隔1秒显示一次时间，因此我修改了这个中断处理函数，使其每隔0.3秒可既可以输出一次当前时间，也可以对蛇进行一次移动。

（2）键盘控制
键盘控制是通过改变9号中断处理函数的功能来实现的，我对int 9的处理时使其只能接受键盘上按的W、A、S、D键，并将其扫描码存入到键盘缓冲区中。w键表示上移，a键表示左移，s键下移，d键右移。 整个过程是先用参数1调用int 16H,判断键盘有没有输入，如果有输入就读取相应的字符并进行判断来修改蛇移动的状态。之后的移动操作是就根据状态来识别坐标应该怎么变换的。
（3）吃果子与分数显示
吃果子的要特别鸣谢一下yyq同学，是他帮我实现的这个功能。
具体的过程如下：
产生果子：通过调用时钟来产生随机值，进而产生果子的随机坐标，最后将果子的坐标显示在屏幕中。
	吃果子：当小蛇的头结点与果子的坐标一致时，让小蛇的长度加一。 

分数显示的过程是用一个变量存储分数，之后在指定位置显示出来，当蛇吃完一个果子之后，分数会加一。
（4）撞墙判断
撞墙判断主要是看蛇头结点的坐标是否与墙壁坐标重合。撞自己主要是判断蛇头坐标是否和自己身体的其他坐标重合
（5）变色
当分数达到4的倍数时，就会改变果子和蛇的输出时的属性值。这样它们再次输出的时候就会发生变色。
4.程序展示
（1）MBR界面

图 1 MBR界面
加载器放在0号扇区，贪吃蛇程序起始位置放在10号扇区。程序开始之后，
MBR修改后按1就会进入贪吃蛇程序，按0会退出，按其他键就会出错。
（2）贪吃蛇程序起始界面

图 2 贪吃蛇起始界面
起始界面，输出提示信息。
（3）贪吃蛇程序执行界面

图 3 贪吃蛇执行界面1

图 4 贪吃蛇执行界面2（变色）
贪吃蛇正常行走的界面，当达到一定的分数时，蛇和果子都会变色。

（4）贪吃蛇程序结束界面

图 5 贪吃蛇程序结束界面1（碰到墙壁）

图 6 贪吃蛇结束界面2（碰到自己）
贪吃蛇在碰到墙壁和自己时会使程序终止。
5.实验感想
这次实验前后一共花了四天时间，感觉这些时间还是很值得的，实现的过程也比较顺利。没有被一个bug困很长时间。在实现键盘控制的时候，我本来把判断上下左右四个键的功能放到int 9中断处理函数中实现的，但是后来发现int 16H总是判断不出什么时候按键，什么时候没有按键，并且这里也没有办法调试，所以我最后只好选择用int 16H中1号参数所带的判断方法来实现。 
最后感谢yyq同学花时间帮我整理的代码！

文件介绍：
MBR.asm		加载器的汇编代码
MBR			加载器的目标文件
snake.asm	贪吃蛇的汇编代码
snake 		贪吃蛇的目标文件